version: '3.7'

services:
  apache:
    build: './apache'
    restart: always
    ports:
      - 8080:80
      - 443:443
    volumes:
      - ./volumes/public_html:/usr/local/apache2/htdocs
      - ./volumes/cert:/usr/local/apache2/cert
    depends_on:
      - php
      - devmysql
      - coldfusion

  php:
    build: './php'
    restart: always
    volumes:
      - ./volumes/public_html:/usr/local/apache2/htdocs
      - ./volumes/tmp:/usr/local/tmp

  devmysql:
    build: './mysql'
    restart: always
    ports:
      - 9906:3306
    environment:
      MYSQL_ROOT_PASSWORD: test1234
      MYSQL_DATABASE: test_db
    volumes:
      - ./volumes/database:/var/lib/mysql

  coldfusion:
    build: './coldfusion'
    restart: always
    ports:
      - 8500:8500
    volumes:
      - ./volumes/coldfusion_root:/app
    env_file:
      - ./coldfusion/coldfusion.env
